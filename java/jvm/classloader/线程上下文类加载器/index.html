<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>fmiles</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="manifest" href="/photo.jpg">
    <link rel="apple-touch-icon" href="/photo.jpg">
    <script src="https://cdn.jsdelivr.net/npm/react/umd/react.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>
    <script>var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?5dd2e8c97962d57b7b8fea1737c01743";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();</script>
    <link rel="alternate" type="application/atom+xml" href="https://fmiles.cn/atom.xml" title="fmiles Atom Feed">
    <link rel="alternate" type="application/json" href="https://fmiles.cn/feed.json" title="fmiles JSON Feed">
    <link rel="alternate" type="application/rss+xml" href="https://fmiles.cn/rss.xml" title="fmiles RSS Feed">
    <meta name="description" content="Java个人博客">
    <meta property="og:url" content="/java/jvm/classloader/%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8.html">
    <meta property="og:site_name" content="fmiles">
    <meta property="og:description" content="当前类加载器(Current Classloader)： 每一个类都会使用自己的类加载器（即加载自身的类加载器）去加载其他的类（指的是所依赖的类）如果Class x 引用了 Class y，那么Class x的类加载器就会去加载Class y（前提是Class y尚未被加载） 线程上下文类加载器（Context ClassLoader）： ​ 线程上下文加载">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="zh-CN">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image:alt" content="fmiles">
    <meta property="article:author" content="siyue">
    <meta name="baidu-site-verification" content="code-IZvTs9l2OK">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.50c6e852.css" as="style"><link rel="preload" href="/assets/js/app.49ac0842.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Layout.0066f2b0.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.25523585.js" as="script"><link rel="preload" href="/assets/js/page--596f90d1.d7e88bb1.js" as="script"><link rel="preload" href="/assets/js/vendors~layout-Blog~layout-Layout.5d8d5532.js" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.50c6e852.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container has-navbar has-sidebar has-anchor"><header class="navbar"><!----> <div class="content__navbar-start"></div> <button title="Sidebar Button" class="sidebar-button"><span class="icon"></span></button> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="fmiles" class="logo"> <!----> <span class="site-name can-hide">fmiles</span></a> <!----> <div class="content__navbar-center"></div> <div class="links"><button tabindex="-1" aria-hidden="true" class="color-button"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="skin-icon"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4
        38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32
        51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0
        102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2
        6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4
        0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2
        9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224
        419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4
        470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0
        22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6
        12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128
        505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2
        16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8
        86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4
        80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6
        6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg> <div class="color-picker-menu" style="display:none;"><div class="theme-options"><ul class="themecolor-select"><label for="themecolor-select">主题色:</label> <li><span class="default-theme"></span></li> </ul> <div class="darkmode-toggle"><label for="darkmode-toggle" class="desc">主题模式:</label> <div class="darkmode-switch"><div class="item day"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon light-icon"><path d="M512 256a42.667 42.667 0 0 0 42.667-42.667V128a42.667 42.667 0 0 0-85.334 0v85.333A42.667 42.667 0 0 0 512 256zm384 213.333h-85.333a42.667 42.667 0 0 0 0 85.334H896a42.667 42.667 0 0 0 0-85.334zM256 512a42.667 42.667 0 0 0-42.667-42.667H128a42.667 42.667 0 0 0 0 85.334h85.333A42.667 42.667 0 0 0 256 512zm9.387-298.667a42.667 42.667 0 0 0-59.307 62.72l61.44 59.307a42.667 42.667 0 0 0 31.147 11.947 42.667 42.667 0 0 0 30.72-13.227 42.667 42.667 0 0 0 0-60.16zm459.946 133.974a42.667 42.667 0 0 0 29.44-11.947l61.44-59.307a42.667 42.667 0 0 0-57.6-62.72l-61.44 60.587a42.667 42.667 0 0 0 0 60.16 42.667 42.667 0 0 0 28.16 13.227zM512 768a42.667 42.667 0 0 0-42.667 42.667V896a42.667 42.667 0 0 0 85.334 0v-85.333A42.667 42.667 0 0 0 512 768zm244.48-79.36a42.667 42.667 0 0 0-59.307 61.44l61.44 60.587a42.667 42.667 0 0 0 29.44 11.946 42.667 42.667 0 0 0 30.72-12.8 42.667 42.667 0 0 0 0-60.586zm-488.96 0-61.44 59.307a42.667 42.667 0 0 0 0 60.586 42.667 42.667 0 0 0 30.72 12.8 42.667 42.667 0 0 0 28.587-10.666l61.44-59.307a42.667 42.667 0 0 0-59.307-61.44zM512 341.333A170.667 170.667 0 1 0 682.667 512 170.667 170.667 0 0 0 512 341.333z" fill="currentColor"></path></svg></div> <div class="item auto active"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon auto-icon"><path d="M460.864 539.072H564.8L510.592 376l-49.728 163.072zM872 362.368V149.504H659.648L510.528 0l-149.12 149.504H149.12v212.928L0 511.872l149.12 149.504v212.928h212.352l149.12 149.504 149.12-149.504h212.352V661.376l149.12-149.504L872 362.368zM614.464 693.12l-31.616-90.624H438.272l-31.616 90.624h-85.888l144.576-407.68h90.368l144.576 407.68h-85.824zm0 0" fill="currentColor"></path></svg></div> <div class="item night"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon dark-icon"><path d="M935.539 630.402c-11.43-11.432-28.674-14.739-43.531-8.354-46.734 20.103-96.363 30.297-147.508 30.297-99.59 0-193.221-38.784-263.64-109.203-108.637-108.637-139.61-270.022-78.908-411.148a39.497 39.497 0 0 0-51.886-51.887c-52.637 22.64-100.017 54.81-140.826 95.616-85.346 85.346-132.346 198.821-132.346 319.52 0 120.7 47.001 234.172 132.347 319.519S408.063 947.11 528.76 947.11c120.7 0 234.172-47.003 319.52-132.351 40.809-40.81 72.978-88.19 95.616-140.826a39.497 39.497 0 0 0-8.356-43.532z" fill="currentColor"></path></svg></div></div> <!----></div></div></div></button> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home.html" class="nav-link"><i class="iconfont icon-java"></i>
  主页
</a></div></nav> <!----> <a rel="noopener noreferrer" href="https://github.com/andle1/fmiles" target="_blank" class="repo-link can-hide">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <!----> <div class="content__navbar-end"></div></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><div vocab="https://schema.org/" typeof="Person" class="blogger-info mobile"><div data-balloon-pos="" role="navigation" class="blogger"><img property="image" alt="Blogger Avatar" src="/logo.jpg" class="avatar round"> <div property="name" class="name">siyue</div> <!----></div> <div class="num-wrapper"><div><div class="num">75</div> <div>文章</div></div> <div><div class="num">7</div> <div>分类</div></div> <div><div class="num">11</div> <div>标签</div></div> <div><div class="num">2</div> <div>时间轴</div></div></div> <div class="media-links-wrapper"><a href="https://github.com/andle1" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="https://gitee.com/siyue01" rel="noopener noreferrer" target="_blank" aria-label="Gitee" data-balloon-pos="up" class="media-link"><span class="sr-only">Gitee</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-gitee"><circle cx="512" cy="512" r="512" fill="#C71D23"></circle> <path d="M772.953 454.723H480.17v.006a25.46 25.46 0 0 0-25.46 25.453l-.025 63.649a25.46 25.46 0 0 0 25.46 25.466l178.242-.007a25.46 25.46 0 0 1 25.459 25.46v12.73c0 42.18-34.198 76.378-76.378 76.378H365.583a25.46 25.46 0 0 1-25.46-25.46V416.533h-.006c0-42.18 34.192-76.378 76.378-76.378h356.388v-.013a25.46 25.46 0 0 0 25.46-25.446l.057-63.65h.013a25.46 25.46 0 0 0-25.46-25.471l-356.432.012c-105.453 0-190.946 85.493-190.946 190.946v356.433a25.46 25.46 0 0 0 25.46 25.46H626.56c94.913 0 171.852-76.94 171.852-171.852V480.182a25.46 25.46 0 0 0-25.46-25.46z" fill="#fff"></path></svg></a></div></div> <hr> <!----> <div class="content__sidebar-top"></div> <nav class="sidebar-nav-links"><div class="nav-item"><a href="/home.html" class="nav-link"><i class="iconfont icon-java"></i>
  主页
</a></div> <a rel="noopener noreferrer" href="https://github.com/andle1/fmiles" target="_blank" class="repo-link">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <!----> <div class="content__sidebar-center"></div> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable open"><i class="iconfont icon-java"></i> <span class="title">Java</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable"><!----> <span class="title">基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable"><!----> <span class="title">集合</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable"><!----> <span class="title">并发</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading clickable open"><!----> <span class="title">JVM</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading clickable"><!----> <span class="title">字节码</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading clickable open"><!----> <span class="title">类加载器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/java/jvm/classloader/ClassLoader%E7%B1%BB%E6%BA%90%E7%A0%81/" class="sidebar-link">classloader 类：</a></li><li><a href="/java/jvm/classloader/Class%E7%B1%BB%E6%BA%90%E7%A0%81/" class="sidebar-link">/java/jvm/classloader/Class%E7%B1%BB%E6%BA%90%E7%A0%81/</a></li><li><a href="/java/jvm/classloader/Launcher%E7%B1%BB%E6%BA%90%E7%A0%81/" class="sidebar-link">/java/jvm/classloader/Launcher%E7%B1%BB%E6%BA%90%E7%A0%81/</a></li><li><a href="/java/jvm/classloader/%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%89%98%E6%9C%BA%E5%88%B6/" class="sidebar-link">/java/jvm/classloader/%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%89%98%E6%9C%BA%E5%88%B6/</a></li><li><a href="/java/jvm/classloader/%E6%95%B0%E7%BB%84%E5%92%8C%E5%B8%B8%E9%87%8F%E5%8A%A0%E8%BD%BD/" class="sidebar-link">数组加载</a></li><li><a href="/java/jvm/classloader/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E4%B8%8E%E5%88%9D%E5%A7%8B%E5%8C%96%E9%98%B6%E6%AE%B5%E5%88%86%E6%9E%90/" class="sidebar-link">初始化阶段静态变量赋值验证：</a></li><li><a href="/java/jvm/classloader/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%85%B8%E5%9E%8B%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/" class="sidebar-link">/java/jvm/classloader/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%85%B8%E5%9E%8B%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90/</a></li><li><a href="/java/jvm/classloader/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/" class="sidebar-link">/java/jvm/classloader/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/</a></li><li><a href="/java/jvm/classloader/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B/" class="sidebar-link">类的加载、连接与初始化 阶段</a></li><li><a href="/java/jvm/classloader/%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/" aria-current="page" class="active sidebar-link">/java/jvm/classloader/%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/</a></li><li><a href="/java/jvm/classloader/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%9A%84%E9%AA%8C%E8%AF%81/" class="sidebar-link">/java/jvm/classloader/%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E7%9A%84%E9%AA%8C%E8%AF%81/</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading clickable"><!----> <span class="title">垃圾回收</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading clickable"><!----> <span class="title">锁</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading clickable"><!----> <span class="title">内存</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-2"><p class="sidebar-heading clickable"><!----> <span class="title">工具</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><!----></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><i class="iconfont icon-database"></i> <span class="title">数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">框架</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">分布式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">系统设计</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading clickable"><!----> <span class="title">工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> <!----> <div class="content__sidebar-bottom"></div> <!----></aside> <main class="page"><nav class="breadcrumb disable"><!----></nav> <!----> <div class="content__page-top"></div> <div vocab="https://schema.org/" typeof="Article" class="page-title"><h1><!----> <span property="headline"></span></h1> <div class="page-info"><!----> <span aria-label="作者🖊" data-balloon-pos="down" categoryPath="/category/$category/" tagPath="/tag/$tag/"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon author-icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z" fill="currentColor"></path></svg> <span property="author">siyue</span></span><span aria-label="访问量🔢" data-balloon-pos="down" defaultAuthor="siyue" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="visitor-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon eye-icon"><path d="M992 512.096c0-5.76-.992-10.592-1.28-11.136-.192-2.88-1.152-8.064-2.08-10.816-.256-.672-.544-1.376-.832-2.08-.48-1.568-1.024-3.104-1.6-4.32C897.664 290.112 707.104 160 512 160c-195.072 0-385.632 130.016-473.76 322.592-1.056 2.112-1.792 4.096-2.272 5.856a55.512 55.512 0 0 0-.64 1.6c-1.76 5.088-1.792 8.64-1.632 7.744-.832 3.744-1.568 11.168-1.568 11.168-.224 2.272-.224 4.032.032 6.304 0 0 .736 6.464 1.088 7.808.128 1.824.576 4.512 1.12 6.976h-.032c.448 2.08 1.12 4.096 1.984 6.08.48 1.536.992 2.976 1.472 4.032C126.432 733.856 316.992 864 512 864c195.136 0 385.696-130.048 473.216-321.696 1.376-2.496 2.24-4.832 2.848-6.912.256-.608.48-1.184.672-1.728 1.536-4.48 1.856-8.32 1.728-8.32l-.032.032c.608-3.104 1.568-7.744 1.568-13.28zM512 672c-88.224 0-160-71.776-160-160s71.776-160 160-160 160 71.776 160 160-71.776 160-160 160z" fill="currentColor"></path></svg> <span id="/java/jvm/classloader/%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8/" class="leancloud_visitors waline-visitor-count"><span class="leancloud-visitors-count">...</span></span></span><!----><!----><!----><span aria-label="阅读时间⌛" data-balloon-pos="down" defaultAuthor="siyue" categoryPath="/category/$category/" tagPath="/tag/$tag/" class="reading-time-info"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon timer-icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z" fill="currentColor"></path></svg> <span>大约 13 分钟</span> <meta property="timeRequired" content="PT13M"></span></div> <!----> <hr></div> <div class="anchor-place-holder"><aside id="anchor"><div class="anchor-wrapper"></div></aside></div> <!----> <div class="content__content-top"></div> <div class="theme-default-content content__default"><p>当前类加载器(Current Classloader)：</p> <p>每一个类都会使用自己的类加载器（即加载自身的类加载器）去加载其他的类（指的是所依赖的类）如果Class x 引用了 Class y，那么Class x的类加载器就会去加载Class y（前提是Class y尚未被加载）</p> <h5 id="线程上下文类加载器-context-classloader"><a href="#线程上下文类加载器-context-classloader" class="header-anchor">#</a> 线程上下文类加载器（Context ClassLoader）：</h5> <p>​        线程上下文加载器是从JDK1.2开始引入的，类 Thread 中的 getContextClassLoader 与setContextClassLoader 分别用来获取和设置上下文加载器，如果没有通过 setContextClassLoader 进行设置的话，线程将会继承其父线程的 上下文类加载器。java 应用运行时的初始线程的上下文类加载器是系统类加载器（这里初始线程上下文加载器是系统类加载器在 Launcher 源码可以看到）。在线程中运行的代码可以通过该类加载器来加载类与资源。</p> <p>通俗的形容：就像一个一直贯通程序执行的容器，里面装着Context ClassLoader，用就拿出来，可以换一个进去，用的时候拿出来就是另外一个。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>源码文档说明：</p> <p><img src="/assets/img/1605106676640.a7d1a22e.png" alt="1605106676640" loading="lazy"></p> <h5 id="线程上下文加载器的重要性"><a href="#线程上下文加载器的重要性" class="header-anchor">#</a> 线程上下文加载器的重要性：</h5> <p>SPI：（Service Provider Interface）</p> <div class="language- extra-class"><pre><code>大部分的 SPI 都是自己用本身的线程上下文加载器加载，当无法加载时才会委托给父加载器，打破了传统的双亲委托模型。
</code></pre></div><p>​         父加载器可以使用当前线程Thread.currentThread().getContextLoader()所指定的classLoader加载的类。 这就改变了父加载不能使用子加载器或者其他没有直接父子关系的ClassLoader加载的类的情况，即改变了双亲委托模型。</p> <p>​        在双亲委托模型下，类加载器是由下至上的，即下层的类会委托上层的类进行加载。但是对于spi来说，有些接口是 JAVA核心类库所提供的，而 Java核心类库是由启动类加载器来加载的，而这些接口的实现却来自于不同的jar 包（厂商提供），只会从 classpath路径加载，Java的启动类加载器是不会加载其它来源的jar包，这样传统的双亲委托模型就无法满足SPI的要求（因为接口是启动类加载器加载的，而实现类是启动类加载器加载的）， 而通过给当前线程设置上下文类加载器，就可以由设置的上下文类加载器来实现对于接口实现类的加载。</p> <p>如下：</p> <p>JDBC 接口是java定义好的，不同的厂商有不同的实现。因为 JDBC 接口位于启动类加载器，故而会被启动类加载器加载，在使用到JDBC实现时，是由 启动类加载器加载的，而这些实现也会由启动类加载器尝试加载，但是这些实现类是位于 classpath 路径，是没办法被加载的。</p> <p><img src="data:image/png;base64,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" alt="1581335409668" loading="lazy"></p> <div class="language-JAVA line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span><span class="token class-name">Driver</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ServiceLoader</span><span class="token punctuation">;</span>

<span class="token comment">/*
    线程上下文加载器的一般使用模式（获取 - 使用 - 还原）
    大部分的框架都是这种使用模式。
    ClassLoader classLoader = Thread.currentThread().getContextClassLoader();

    Try{
          // targetTccl是自己通过某种方式的得到的加载
        Thread.currentThread().setContextClassLoader(targetTccl);
        myMethod();//这个方法是使用设置的类加载器去加载
    }finally{
        //记得还原上下文类加载器，不然就直接改变了上下文类加载器
        Thread.currentThread().setContextClassLoader(classLoader);
    }

    myMethod 里面则调用了Thread.currentThread().getContextClassLoader(),获取当前线程的上下文类加载器做某些事情。
    如果一个类由类加载器A加载，那么这个类的依赖类也是由通用的类加载器加载的（如果该依赖类之前没有被加载过）
    ContextClassLoader的作用就是为了破坏Java的类加载委托机制。
    当高层提供了统一的接口让低层去实现，同时又要在高层加载（或实例化）底层的类时，就必须要通过线程上下文类加载器来帮助高层的ClassLoader找到并加载该类
* */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTest20</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 这里执行完就是创建了 ServiceLoader。</span>
        <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Driver</span><span class="token punctuation">&gt;</span></span> loader <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Driver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span>Driver</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">Driver</span> driver <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;driver: &quot;</span><span class="token operator">+</span>driver<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;, loader: &quot;</span><span class="token operator">+</span>driver<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;当前线程上下文类加载器：&quot;</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ServiceLoader的类加载器：&quot;</span><span class="token operator">+</span><span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>结果：</p> <div class="language-JAVA line-numbers-mode"><pre class="language-java"><code>driver<span class="token operator">:</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span>Driver</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">AppClassLoader</span><span class="token annotation punctuation">@18b4aac2</span>
driver<span class="token operator">:</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>fabric<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span></span>FabricMySQLDriver</span><span class="token punctuation">,</span> loader<span class="token operator">:</span> <span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">AppClassLoader</span><span class="token annotation punctuation">@18b4aac2</span>
当前线程上下文类加载器：<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">AppClassLoader</span><span class="token annotation punctuation">@18b4aac2</span>
<span class="token class-name">ServiceLoader</span>的类加载器：<span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>分析：</p> <p>在系统类加载器加载MyTest20 以后，会继续尝试加载 ServiceLoader 类，根据双亲委托机制，最后启动类加载器是可以加载ServiceLoader ，因为这就是java定义的规范，在load 方法执行的时候，启动类加载器是为无法加载的，所以会 获取上下文加载器去加载。（通常情况下，在没有自定义系统类加载器的时候，线程上下文加载器都是系统类加载器）</p> <p>SeiviceLoader 的应用：</p> <p>用于加载服务的具体实现。为什么能通过ServiceLoader.load(Driver.class)这样的 Driver.Class 就能加载实现类，原因就是ServiceLoader里面直接定义了加载的服务的路径，然后会读取这个文件每一行，这里的输出就是定义好的两个Driver。</p> <p>读取 META-INF/services/完全限定名 目录下的文件，读取每一行：</p> <p><img src="/assets/img/1606141498384.1f723cf6.png" alt="1606141498384" loading="lazy"></p> <p>具体看源文档。</p> <p>当加入 Thread.currentThread().setContextClassLoader(MyTest20.class.getClassLoader().getParent());结果变为：</p> <div class="language-JAVA line-numbers-mode"><pre class="language-java"><code>当前线程上下文类加载器：<span class="token class-name"><span class="token namespace">sun<span class="token punctuation">.</span>misc<span class="token punctuation">.</span></span>Launcher</span>$<span class="token class-name">ExtClassLoader</span><span class="token annotation punctuation">@74a14482</span>
<span class="token class-name">ServiceLoader</span>的类加载器：<span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>​       因为系统会用扩展类加载器去加载，故并不会加载到系统类加载器的内容，那就不会加载厂商提供的这些实现类。查看SeiviceLoader .load可知,SeiviceLoader 在加载一个类的时候会用当前线程的类加载器去加载;</p> <p><img src="/assets/img/1606143466220.6c60dccc.png" alt="1606143466220" loading="lazy"></p> <hr> <h5 id="jar-hell-问题"><a href="#jar-hell-问题" class="header-anchor">#</a> Jar hell 问题：</h5> <ul><li>当一个类或者一个资源文件存在于多个 jar 中，就会存在 jar hell 问题。</li> <li>可以通过以下代码诊断问题：</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JarHell</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">ClassLoader</span> classLoader <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> resourceName <span class="token operator">=</span> <span class="token string">&quot;java/lang/String.class&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">// 通过classL 获取资源</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span>URL<span class="token punctuation">&gt;</span></span> urls <span class="token operator">=</span> classLoader<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>resourceName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 再获取jar 包位于哪些地方</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>urls<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">URL</span> url <span class="token operator">=</span> urls<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>结果：</p> <p><img src="data:image/png;base64,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" alt="1581436794995" loading="lazy"></p> <hr> <h4 id="serviceloader-类源码解析"><a href="#serviceloader-类源码解析" class="header-anchor">#</a> ServiceLoader 类源码解析：</h4> <p>java.util public final class ServiceLoader<S>  extends Object  implements Iterable<S></S></S></p> <p>作用就是用于加载服务的具体实现</p> <h5 id="文档说明"><a href="#文档说明" class="header-anchor">#</a> 文档说明：</h5> <p>1、一个简单的服务提供者加载设施。</p> <blockquote><p>ServiceLoader 就是针对 SPI  所提出的加载设施</p></blockquote> <p>2、服务就是已知的抽象类和接口的集合。服务提供者是对服务的具体实现。服务提供者通常都会实现服务本身定义的接口和继承服务本身的类。服务提供者是可以被安装到 java 平台以一种扩展的实现，比如说以 jar 文件形式放置到任何扩展目录的下面。提供者还可以变的可用通过将自身添加到应用的类路径或者一些特定于平台的方法。</p> <blockquote><p>第二句解释：其实就是实现接口和继承抽象类。</p> <p>最后一句解释：就是添加到系统类加载器的类路径上以便可用被系统类加载器加载。</p></blockquote> <p>3、出于加载的目的，服务是一个单个的类型去表示的，也就是说一个单个的接口或者是抽象类（可以使用抽象类，但是不推荐去使用它）。给定服务的提供者会包含一个或者多个具体的类去扩展服务类型用给定的数据或者代码。提供者类通常不是全完是提供者本身而是一个代理，这个代理包含了足够的信息去确定服务提供者是否能满足特定的需求，并且加上部分代码就能够根据需要创建实际的提供者。提供者类的细节是和服务高度相关的，没有单个的类或接口能够统一它们，因此并没有定义这种类型。对于这个设施来说唯一的需求就是必须有一个无参构造方法，这样它们在加载的时候就能被实例化。</p> <p>4、服务提供者是通过将服务提供者的配置文件放置在资源目录的META-INF/services 目录下去标识自身。文件的名称则是此服务类型的完全限定二进制名称。文件包含了一个具体创建的提供者类的完全限定二进制类名的列表，每个类名称一行。空格和tab键以及相应的空格行都会被忽略掉。注释字符是 # 号；在第一个注释字符后面所有的字符都会被忽略掉。这个文件必须是 UTF-8格式编码。</p> <blockquote><p>解释：就是服务提供者要以某种方式告诉 jdk 提供的类是啥</p> <p>文件的名称则是此服务类型的完全限定二进制名称表名这个配置文件的名称就是实现的接口名称。</p> <p>这个图就解释了这段话，配置文件就是这样的。服务提供者就是其中的一行指向的类</p></blockquote> <p><img src="data:image/png;base64,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" alt="1581342097120" loading="lazy"></p> <p>5、如果在多个配置文件都出现了一个具体的服务提供者类名称，或者这个类名在相同的配置文件里面出现了多次，重复的就会被忽略掉。配置文件的名称是不需要位于相同的 jar 文件或者提供者的其他分发单元里面。提供者必须是能被与最初定位配置文件的类加载器加载；注意这个类加载器对于实际被加载的类并不是必要的。</p> <p>6、提供者是延迟定位和实例化的，也就是说按需求定位或者实例化。一个服务的加载器会包到目前为止的提供者的缓存。每一次对于 iterator 方法的调用都会返回一个迭代器，它首先以实例化的顺序缓存所有的元素，然后延迟定位和实例化其他的提供者，再添加到缓存里面。缓存可以通过 reload 方法被清空。</p> <blockquote><p>解释：服务提供者是需要的时候才会被加载的，而 SeiviceLoader 里面会缓存这些已经被加载后的提供者。</p></blockquote> <p>7、安全性说明。。。。。不必过多了解。</p> <p><img src="/assets/img/1606058582937.090597c1.png" alt="1606058582937" loading="lazy"></p> <p><img src="/assets/img/1606058615179.e53ead70.png" alt="1606058615179" loading="lazy"></p> <h5 id="源码分析"><a href="#源码分析" class="header-anchor">#</a> 源码分析：</h5> <p>示例代码（一般框架也是和下面代码使用一样的加载方式）：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyTest20</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// z这里执行完就是创建了 ServiceLoader。</span>
        <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Driver</span><span class="token punctuation">&gt;</span></span> loader <span class="token operator">=</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Driver</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建迭代器对象</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span></span>Driver</span><span class="token punctuation">&gt;</span></span> iterator <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span> <span class="token punctuation">(</span>iterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">Driver</span> driver <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;driver: &quot;</span><span class="token operator">+</span>driver<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;, loader: &quot;</span><span class="token operator">+</span>driver<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;当前线程上下文类加载器：&quot;</span><span class="token operator">+</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ServiceLoader的类加载器：&quot;</span><span class="token operator">+</span><span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Iterable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token comment">//这里就解释类为什么是 META-INF/services 文件夹</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> PREFIX <span class="token operator">=</span> <span class="token string">&quot;META-INF/services/&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">// The class or interface representing the service being loaded</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> service<span class="token punctuation">;</span>
    <span class="token comment">// The class loader used to locate, load, and instantiate providers</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ClassLoader</span> loader<span class="token punctuation">;</span>
    <span class="token comment">// 这里就是服务提供者的缓存。</span>
    <span class="token keyword">private</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> providers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// LazyIterator 对象</span>
    <span class="token keyword">private</span> <span class="token class-name">LazyIterator</span> lookupIterator<span class="token punctuation">;</span>
    <span class="token comment">// The access control context taken when the ServiceLoader is created</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">AccessControlContext</span> acc<span class="token punctuation">;</span>
        
    <span class="token comment">//、、 使用当前线程的上下文加载器去创建给的服务类型、、//</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> service<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果这里不是线程上下文加载器， 执行 ServiceLoader&lt;Driver&gt; loader = ServiceLoader.load(Driver.class) 时，会由加载调用类的加载器（即启动类加载）尝试加载ServiceLoader，因为双亲委托的存在，会直接委托到启动类加载器，而启动类加载器是可以加载的，故而load方法里面的内容也是由启动类加载器加载，但是 load 的Driver 是位于classpath下面，启动类加载器加载不到。这时候，在load方法里面，把启动类加载器换为系统类加载器去加载 Driver。</span>
        <span class="token class-name">ClassLoader</span> cl <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> cl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

      <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> service<span class="token punctuation">,</span><span class="token class-name">ClassLoader</span> loader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ServiceLoader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">private</span> <span class="token class-name">ServiceLoader</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> svc<span class="token punctuation">,</span> <span class="token class-name">ClassLoader</span> cl<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        service <span class="token operator">=</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>svc<span class="token punctuation">,</span> <span class="token string">&quot;Service interface cannot be null&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 当前线程上下文加载没设置的话就使用 系统类加载器</span>
        loader <span class="token operator">=</span> <span class="token punctuation">(</span>cl <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> cl<span class="token punctuation">;</span>
        acc <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token comment">//清空缓存</span>
        <span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
     <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token comment">// 清空服务提供者的缓存</span>
        providers<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 创建 LazyIterator 对象</span>
        lookupIterator <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LazyIterator</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 获取迭代器对象</span>
    <span class="token keyword">public</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 匿名内部类的方式产生 Iterator 实例</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 已经加载的 Providers</span>
            <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> knownProviders <span class="token operator">=</span> providers<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	    <span class="token comment">// 判断是否有下一个</span>
            <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>knownProviders<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token comment">// 这里的 lookupIterator 就是在执行reload()所创建的 LazyIterator 对象</span>
                <span class="token keyword">return</span> lookupIterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">//获取 服务提供者对象</span>
            <span class="token keyword">public</span> <span class="token class-name">S</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>knownProviders<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> knownProviders<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> lookupIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token punctuation">.</span>
    <span class="token punctuation">.</span>
    <span class="token punctuation">.</span>
        
   <span class="token comment">/* 内部类 LazyIterator */</span>
   <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">LazyIterator</span> <span class="token keyword">implements</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>
        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> service<span class="token punctuation">;</span>
        <span class="token class-name">ClassLoader</span> loader<span class="token punctuation">;</span>
        <span class="token class-name">Enumeration</span><span class="token generics"><span class="token punctuation">&lt;</span>URL<span class="token punctuation">&gt;</span></span> configs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> pending <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> nextName <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
       
        <span class="token keyword">private</span> <span class="token class-name">LazyIterator</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> service<span class="token punctuation">,</span> <span class="token class-name">ClassLoader</span> loader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>service <span class="token operator">=</span> service<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>loader <span class="token operator">=</span> loader<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    
       <span class="token keyword">public</span> <span class="token class-name">S</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>acc <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">nextService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span> action <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrivilegedAction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">S</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">public</span> <span class="token class-name">S</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">nextService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> acc<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">//、、返回服务提供者、、//</span>
        <span class="token keyword">private</span> <span class="token class-name">S</span> <span class="token function">nextService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">hasNextService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchElementException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> cn <span class="token operator">=</span> nextName<span class="token punctuation">;</span>
            nextName <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// 创建 Class 对象实例。根据 hasNextService 方法设置的nextName，也就是找到的 Class 对象的完全限定名，调用forName方法，这里的 loader 就是在调用 load() 方法的时候实例化 ServiceLoader的时候设置的系统类加载器，从当前线程上下文加载器中获取的</span>
                c <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span>cn<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> loader<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">fail</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span><span class="token string">&quot;Provider &quot;</span> <span class="token operator">+</span> cn <span class="token operator">+</span> <span class="token string">&quot; not found&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>service<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">fail</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span><span class="token string">&quot;Provider &quot;</span> <span class="token operator">+</span> cn  <span class="token operator">+</span> <span class="token string">&quot; not a subtype&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">S</span> p <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">cast</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 把新建的服务提供者实例放入缓存里面</span>
                providers<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>cn<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> p<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">fail</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> <span class="token string">&quot;Provider &quot;</span> <span class="token operator">+</span> cn <span class="token operator">+</span> <span class="token string">&quot; could not be instantiated&quot;</span><span class="token punctuation">,</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// This cannot happen</span>
        <span class="token punctuation">}</span>
    
        <span class="token comment">//、、判断是否有下一个服务提供者、、//</span>
        <span class="token keyword">private</span> <span class="token keyword">boolean</span> <span class="token function">hasNextService</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 下一行不为空，说明还有下一个服务提供者</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>nextName <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>configs <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 拼接名，前缀名加Class对象名称</span>
                    <span class="token class-name">String</span> fullName <span class="token operator">=</span> PREFIX <span class="token operator">+</span> service<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// loader 为空说明使用系统类加载器</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loader <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                        <span class="token comment">// 加载配置文件</span>
                        configs <span class="token operator">=</span> <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">getSystemResources</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">else</span>
                        configs <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">getResources</span><span class="token punctuation">(</span>fullName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">fail</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> <span class="token string">&quot;Error locating configuration files&quot;</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 解析内容，不断地判断。</span>
            <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pending <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>pending<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>configs<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment">// 读取了配置文件的内容</span>
                pending <span class="token operator">=</span> <span class="token function">parse</span><span class="token punctuation">(</span>service<span class="token punctuation">,</span> configs<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 解析完的配置文件的每一行所写类二进制名称（返回的是读过的那一行数据，而不是下一行）</span>
            nextName <span class="token operator">=</span> pending<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span>
        <span class="token punctuation">.</span>
        <span class="token punctuation">.</span>

<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br></div></div></div> <!----> <div class="content__content-bottom"></div> <footer class="page-meta"><div class="edit-link"><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon edit-icon"><path d="M117.953 696.992 64.306 959.696l265.931-49.336 450.204-452.505-212.284-213.376-450.204 452.513zm496.384-296.326L219.039 797.993l-46.108-46.34L568.233 354.33l46.104 46.335zm345.357-122.99-114.45 115.04-212.288-213.377 114.45-115.035 212.288 213.371zm0 0" fill="currentColor"></path></svg> <a href="https://github.com/andle1/fmiles/edit/main/docs/java/jvm/classloader/线程上下文类加载器.md" target="_blank" rel="noopener noreferrer">编辑此页</a></div> <!----> <!----></footer> <!----> <!----> <!----> <div class="content__page-bottom"></div></main> <footer class="footer-wrapper"><div class="media-links-wrapper"><a href="https://github.com/andle1" rel="noopener noreferrer" target="_blank" aria-label="Github" data-balloon-pos="up" class="media-link"><span class="sr-only">Github</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-github"><circle cx="512" cy="512" r="512" fill="#171515"></circle> <path d="M509.423 146.442c-200.317 0-362.756 162.42-362.756 362.8 0 160.266 103.936 296.24 248.109 344.217 18.139 3.327 24.76-7.872 24.76-17.486 0-8.613-.313-31.427-.49-61.702-100.912 21.923-122.205-48.63-122.205-48.63-16.495-41.91-40.28-53.067-40.28-53.067-32.937-22.51 2.492-22.053 2.492-22.053 36.407 2.566 55.568 37.386 55.568 37.386 32.362 55.438 84.907 39.43 105.58 30.143 3.296-23.444 12.667-39.43 23.032-48.498-80.557-9.156-165.246-40.28-165.246-179.297 0-39.604 14.135-71.988 37.342-97.348-3.731-9.178-16.18-46.063 3.556-96.009 0 0 30.46-9.754 99.76 37.19 28.937-8.048 59.97-12.071 90.823-12.211 30.807.14 61.843 4.165 90.822 12.21 69.26-46.944 99.663-37.189 99.663-37.189 19.792 49.946 7.34 86.831 3.61 96.01 23.25 25.359 37.29 57.742 37.29 97.347 0 139.366-84.82 170.033-165.637 179.013 13.026 11.2 24.628 33.342 24.628 67.182 0 48.498-.445 87.627-.445 99.521 0 9.702 6.535 20.988 24.945 17.444 144.03-48.067 247.881-183.95 247.881-344.175 0-200.378-162.442-362.798-362.802-362.798z" fill="#FFF"></path></svg></a><a href="https://gitee.com/siyue01" rel="noopener noreferrer" target="_blank" aria-label="Gitee" data-balloon-pos="up" class="media-link"><span class="sr-only">Gitee</span> <svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon icon-gitee"><circle cx="512" cy="512" r="512" fill="#C71D23"></circle> <path d="M772.953 454.723H480.17v.006a25.46 25.46 0 0 0-25.46 25.453l-.025 63.649a25.46 25.46 0 0 0 25.46 25.466l178.242-.007a25.46 25.46 0 0 1 25.459 25.46v12.73c0 42.18-34.198 76.378-76.378 76.378H365.583a25.46 25.46 0 0 1-25.46-25.46V416.533h-.006c0-42.18 34.192-76.378 76.378-76.378h356.388v-.013a25.46 25.46 0 0 0 25.46-25.446l.057-63.65h.013a25.46 25.46 0 0 0-25.46-25.471l-356.432.012c-105.453 0-190.946 85.493-190.946 190.946v356.433a25.46 25.46 0 0 0 25.46 25.46H626.56c94.913 0 171.852-76.94 171.852-171.852V480.182a25.46 25.46 0 0 0-25.46-25.46z" fill="#fff"></path></svg></a></div> <div class="footer"><a href="https://beian.miit.gov.cn/" target="_blank">皖ICP备19004457号</a></div> <div class="copyright">Copyright © 2022 siyue</div></footer></div><div class="global-ui"><!----><!----><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="关闭" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">该应用可以安装在您的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和您的操作系统安全地进行交互。</p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>详情</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        安装 <span></span></button> <button class="cancel-button">
        取消
      </button></div></div></div></div><div tabindex="-1" role="dialog" aria-hidden="true" class="pswp"><div class="pswp__bg"></div> <div class="pswp__scroll-wrap"><div class="pswp__container"><div class="pswp__item"></div> <div class="pswp__item"></div> <div class="pswp__item"></div></div> <div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><div class="pswp__counter"></div> <button title="关闭" aria-label="关闭" class="pswp__button pswp__button--close"></button> <button title="分享" aria-label="分享" class="pswp__button pswp__button--share"></button> <button title="切换全屏" aria-label="切换全屏" class="pswp__button pswp__button--fs"></button> <button title="缩放" aria-label="缩放" class="pswp__button pswp__button--zoom"></button> <div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div> <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div> <button title="上一个 (左箭头)" aria-label="上一个 (左箭头)" class="pswp__button pswp__button--arrow--left"></button> <button title="下一个 (右箭头)" aria-label="下一个 (右箭头)" class="pswp__button pswp__button--arrow--right"></button> <div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div></div></div>
    <script src="/assets/js/app.49ac0842.js" defer></script><script src="/assets/js/vendors~layout-Layout.0066f2b0.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout~layout-NotFound.25523585.js" defer></script><script src="/assets/js/page--596f90d1.d7e88bb1.js" defer></script><script src="/assets/js/vendors~layout-Blog~layout-Layout.5d8d5532.js" defer></script>
  </body>
</html>
